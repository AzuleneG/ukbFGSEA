<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fast Preranked Gene Set Enrichment Analysis for UK Biobank Genebass Data • ukbFGSEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fast Preranked Gene Set Enrichment Analysis for UK Biobank Genebass Data">
<meta property="og:description" content="This package provides tools for conducting fast pre-ranked gene set enrichment analysis (FGSEA) on the UK Biobank Genebass dataset using the adaptive multilevel splitting Monte Carlo method implemented in `fgsea`. It includes functions for mapping FGSEA results across multiple phenotypes and tidying the output for further analysis.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ukbFGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ukbfgsea">ukbFGSEA<a class="anchor" aria-label="anchor" href="#ukbfgsea"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of ukbFGSEA is to apply gene set enrichment analysis, based on FGSEA package, to Genebass data released by Karczewski et al. The package is amed to help researchers to perform detailed evaluations of gene set enrichment across a wide range of phenotypes. The package mainly includes three functions:</p>
<ul>
<li><p><code><a href="reference/ukbfgsea.html">ukbfgsea()</a></code> applies <code><a href="https://rdrr.io/pkg/fgsea/man/fgseaMultilevel.html" class="external-link">fgsea::fgseaMultilevel()</a></code> - an adaptive multilevel splitting Monte Carlo approach, to a single phenotype in the UK Biobank Genebass dataset for a specified input gene set.</p></li>
<li><p><code><a href="reference/map_ukbfgsea.html">map_ukbfgsea()</a></code> applies <code><a href="https://rdrr.io/pkg/fgsea/man/fgseaMultilevel.html" class="external-link">fgsea::fgseaMultilevel()</a></code> to multiple phenotypes in the UK Biobank Genebass dataset for a specified input gene set. This function is suitable for large-scale(or full) Genebass dataset.</p></li>
<li><p><code><a href="reference/tidy_map.html">tidy_map()</a></code> organizes the raw output of <code><a href="reference/map_ukbfgsea.html">map_ukbfgsea()</a></code> to a tibble including distinct columns for each phenotype and each ranking method, providing a clear and accessible summary of the FGSEA results.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ukbFGSEA like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ctlab/fgsea"</span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"AzuleneG/ukbFGSEA"</span><span class="op">)</span></span></code></pre></div>
<p><code>genebass_test_data</code> is a test data originated from <code>results.mt</code> provided on the Genebass website. The package implements it as a test data set for testing the functions. We includes the documentation of this dataset, but because this test data is very large (220.6MB), the file is only provided in the releases of repo <code>AzuleneG/ukbFGSEA</code>. You can install the data like so:</p>
<p>DO NOT install <code>piggyback</code> from CRAN to avoid a possible bug. Use <code>install_github()</code> instead.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ropensci/piggyback"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/piggyback" class="external-link">piggyback</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">piggyback</span><span class="fu">::</span><span class="fu">pb_download</span><span class="op">(</span><span class="st">"genebass_test_data.rda"</span>,</span>
<span>    repo <span class="op">=</span> <span class="st">"AzuleneG/ukbFGSEA"</span>,</span>
<span>    dest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/genebass_test_data.rda"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This example shows how to use <code><a href="reference/map_ukbfgsea.html">map_ukbfgsea()</a></code> to apply FGSEA on Genebass data, using the test data attached in the package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ukbFGSEA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">genebass_test_data</span> </span>
<span></span>
<span><span class="va">genebass_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">trait_type</span>, <span class="va">phenocode</span>, <span class="va">description</span>, <span class="va">description_more</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># then apply ukbfgsea to three phenotypes for each of gene set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">asd_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">ASD185</span>, multiple_phenotypes <span class="op">=</span> <span class="va">genebass_test_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">asd_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">asd_output</span><span class="op">)</span></span>
<span><span class="va">asd_output_tidy</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Welcome to the <code>ukbFGSEA</code> tutorial. This package is designed for performing fast pre-ranked gene set enrichment analysis (FGSEA) specifically tailored for the UK Biobank Genebass dataset. This tutorial aims to guide you through the effective use of the package, employing practical examples using gene sets related to Autism Spectrum Disorder (ASD), Developmental Delay (DD), and Neurodevelopmental Disorders (NDD).</p>
</div>
<div class="section level3">
<h3 id="practical-examples">Practical Examples<a class="anchor" aria-label="anchor" href="#practical-examples"></a>
</h3>
<div class="section level4">
<h4 id="example-1-quick-test-run">Example 1: Quick Test Run<a class="anchor" aria-label="anchor" href="#example-1-quick-test-run"></a>
</h4>
<p>Since the Genebass data, including 4,529 phenotypes, is very large, running ukbFGSEA on all of them can take quite many hours. To illustrate how to run ukbFGSEA, we will use three phenotypes from Genebass as an example for a quick test run. Later, we will describe how to read in data, including all phenotypes from Genebass and apply ukbFGSEA to them.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, load the libraries, Genebass Test Data, ASD Gene Set, DD Gene Set and NDD Gene Set</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ukbFGSEA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/piggyback" class="external-link">piggyback</a></span><span class="op">)</span> <span class="co">#Only for test data</span></span>
<span></span>
<span><span class="co"># Download and load test data</span></span>
<span></span>
<span><span class="fu">pb_download</span><span class="op">(</span><span class="st">"genebass_test_data.rda"</span>,</span>
<span>    repo <span class="op">=</span> <span class="st">"AzuleneG/ukbFGSEA"</span>,</span>
<span>    dest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"/genebass_test_data.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the structure of the test data</span></span>
<span><span class="va">genebass_test_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">annotation</span>,</span>
<span>        <span class="va">trait_type</span>,</span>
<span>        <span class="va">phenocode</span>,</span>
<span>        <span class="va">description</span>,</span>
<span>        <span class="va">description_more</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">## # A tibble: 12 × 6</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">##    annotation       trait_type  phenocode description     description_more     n</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;            &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;            &lt;int&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">##  1 missense|LC      categorical      6150 Vascular/heart… "ACE touchscree… 19052</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">##  2 missense|LC      continuous      22200 Year of birth   "Year of birth … 19389</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">##  3 missense|LC      continuous      30760 HDL cholesterol "Measured by en… 19304</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">##  4 pLoF             categorical      6150 Vascular/heart… "ACE touchscree… 18027</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">##  5 pLoF             continuous      22200 Year of birth   "Year of birth … 17579</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">##  6 pLoF             continuous      30760 HDL cholesterol "Measured by en… 18220</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">##  7 pLoF|missense|LC categorical      6150 Vascular/heart… "ACE touchscree… 18281</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">##  8 pLoF|missense|LC continuous      22200 Year of birth   "Year of birth … 18611</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">##  9 pLoF|missense|LC continuous      30760 HDL cholesterol "Measured by en… 18530</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="do">## 10 synonymous       categorical      6150 Vascular/heart… "ACE touchscree… 19023</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="do">## 11 synonymous       continuous      22200 Year of birth   "Year of birth … 19342</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## 12 synonymous       continuous      30760 HDL cholesterol "Measured by en… 19272</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply ukbfgsea to three phenotypes for each gene set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">asd_test_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">ASD185</span>, multiple_phenotypes <span class="op">=</span> <span class="va">genebass_test_data</span><span class="op">)</span></span>
<span><span class="va">asd_test_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">asd_test_output</span><span class="op">)</span></span>
<span><span class="va">asd_test_output_tidy</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">## # A tibble: 12 × 33</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="do">##    annotation       n_cases n_controls heritability saige_version inv_normalized</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;lgl&gt;         </span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="do">##  1 missense|LC         9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">##  2 pLoF                9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="do">##  3 synonymous          9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="do">##  4 pLoF|missense|LC    9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="do">##  5 missense|LC        99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="do">##  6 pLoF               99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="do">##  7 synonymous         99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="do">##  8 pLoF|missense|LC   99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="do">##  9 missense|LC       344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="do">## 10 pLoF              344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="do">## 11 synonymous        344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="do">## 12 pLoF|missense|LC  344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="do">## # ℹ 27 more variables: trait_type &lt;chr&gt;, phenocode &lt;dbl&gt;, pheno_sex &lt;chr&gt;,</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="do">## #   coding &lt;dbl&gt;, modifier &lt;chr&gt;, n_cases_defined &lt;dbl&gt;,</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="do">## #   n_cases_both_sexes &lt;dbl&gt;, n_cases_females &lt;dbl&gt;, n_cases_males &lt;dbl&gt;,</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="do">## #   description &lt;chr&gt;, description_more &lt;chr&gt;, coding_description &lt;chr&gt;,</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="do">## #   category &lt;chr&gt;, beta_pval &lt;dbl&gt;, beta_padj &lt;dbl&gt;, beta_log2err &lt;dbl&gt;,</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="do">## #   beta_ES &lt;dbl&gt;, beta_NES &lt;dbl&gt;, beta_size &lt;int&gt;, beta_leadingEdge &lt;list&gt;,</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="do">## #   sign_pval &lt;dbl&gt;, sign_padj &lt;dbl&gt;, sign_log2err &lt;dbl&gt;, sign_ES &lt;dbl&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">dd_test_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">DD477</span>, multiple_phenotypes <span class="op">=</span> <span class="va">genebass_test_data</span><span class="op">)</span></span>
<span><span class="va">dd_test_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">dd_test_output</span><span class="op">)</span></span>
<span><span class="va">dd_test_output_tidy</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="do">## # A tibble: 12 × 33</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="do">##    annotation       n_cases n_controls heritability saige_version inv_normalized</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;lgl&gt;         </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">##  1 missense|LC         9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">##  2 pLoF                9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">##  3 synonymous          9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">##  4 pLoF|missense|LC    9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">##  5 missense|LC        99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">##  6 pLoF               99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="do">##  7 synonymous         99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="do">##  8 pLoF|missense|LC   99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="do">##  9 missense|LC       344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="do">## 10 pLoF              344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="do">## 11 synonymous        344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="do">## 12 pLoF|missense|LC  344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="do">## # ℹ 27 more variables: trait_type &lt;chr&gt;, phenocode &lt;dbl&gt;, pheno_sex &lt;chr&gt;,</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="do">## #   coding &lt;dbl&gt;, modifier &lt;chr&gt;, n_cases_defined &lt;dbl&gt;,</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="do">## #   n_cases_both_sexes &lt;dbl&gt;, n_cases_females &lt;dbl&gt;, n_cases_males &lt;dbl&gt;,</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="do">## #   description &lt;chr&gt;, description_more &lt;chr&gt;, coding_description &lt;chr&gt;,</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="do">## #   category &lt;chr&gt;, beta_pval &lt;dbl&gt;, beta_padj &lt;dbl&gt;, beta_log2err &lt;dbl&gt;,</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="do">## #   beta_ES &lt;dbl&gt;, beta_NES &lt;dbl&gt;, beta_size &lt;int&gt;, beta_leadingEdge &lt;list&gt;,</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="do">## #   sign_pval &lt;dbl&gt;, sign_padj &lt;dbl&gt;, sign_log2err &lt;dbl&gt;, sign_ES &lt;dbl&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">ndd_test_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">NDD664</span>, multiple_phenotypes <span class="op">=</span> <span class="va">genebass_test_data</span><span class="op">)</span></span>
<span><span class="va">ndd_test_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">ndd_test_output</span><span class="op">)</span></span>
<span><span class="va">ndd_test_output_tidy</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">## # A tibble: 12 × 33</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">##    annotation       n_cases n_controls heritability saige_version inv_normalized</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;lgl&gt;         </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="do">##  1 missense|LC         9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="do">##  2 pLoF                9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="do">##  3 synonymous          9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="do">##  4 pLoF|missense|LC    9308     384687       0.0604 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="do">##  5 missense|LC        99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="do">##  6 pLoF               99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="do">##  7 synonymous         99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="do">##  8 pLoF|missense|LC   99877         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="do">##  9 missense|LC       344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="do">## 10 pLoF              344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="do">## 11 synonymous        344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="do">## 12 pLoF|missense|LC  344938         NA       0      SAIGE_0.44.5  FALSE         </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="do">## # ℹ 27 more variables: trait_type &lt;chr&gt;, phenocode &lt;dbl&gt;, pheno_sex &lt;chr&gt;,</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="do">## #   coding &lt;dbl&gt;, modifier &lt;chr&gt;, n_cases_defined &lt;dbl&gt;,</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="do">## #   n_cases_both_sexes &lt;dbl&gt;, n_cases_females &lt;dbl&gt;, n_cases_males &lt;dbl&gt;,</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="do">## #   description &lt;chr&gt;, description_more &lt;chr&gt;, coding_description &lt;chr&gt;,</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="do">## #   category &lt;chr&gt;, beta_pval &lt;dbl&gt;, beta_padj &lt;dbl&gt;, beta_log2err &lt;dbl&gt;,</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="do">## #   beta_ES &lt;dbl&gt;, beta_NES &lt;dbl&gt;, beta_size &lt;int&gt;, beta_leadingEdge &lt;list&gt;,</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="do">## #   sign_pval &lt;dbl&gt;, sign_padj &lt;dbl&gt;, sign_log2err &lt;dbl&gt;, sign_ES &lt;dbl&gt;, …</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-2-applying-ukbfgsea-on-genebass-data-including-all-phenotypes">Example 2: Applying ukbFGSEA on Genebass Data Including All Phenotypes<a class="anchor" aria-label="anchor" href="#example-2-applying-ukbfgsea-on-genebass-data-including-all-phenotypes"></a>
</h4>
<p>If you’d like to run ukbFGSEA on all phenotypes in the UK Biobank, first download the entire Genebass dataset from <a href="https://drive.google.com/file/d/1j0bAXm2AYmZNQxQBbFODien0dpKUGCHn/view?usp=drive_link" class="external-link">Google Drive</a>. Reading in the data may take several hours due to its large size. The runtime of ukbFGSEA depends on the number of phenotypes provided to the map_ukbfgsea function. Therefore, we suggest filtering out phenotypes that are not relevant to your interests and those with small sample sizes in the UK Biobank, as they lack power in burden tests. Generally, we recommend filtering out phenotypes with case sample sizes &lt; 3000 and those with descriptions starting with “Date”. You are welcome to apply your own filtering criteria to clean the phenotypes.</p>
<p>In the following code example, we apply our recommended filters and focus on the burden test results of pLoF (protein-truncating) variants. Since it may take many hours to run ukbFGSEA on thousands of phenotypes, we provide the tidy output of map_ukbfgsea on filtered phenotypes in our package for users as an example. Users can simply load the data <code>asd_all_output_tidy</code>, <code>dd_all_output_tidy</code>, and <code>ndd_all_output_tidy</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ukbFGSEA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_phenotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"/the/path/to/genebass_all_phenotypes.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">phenotypes_filtered</span> <span class="op">&lt;-</span> <span class="va">all_phenotypes</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n_cases</span> <span class="op">&gt;=</span> <span class="fl">3000</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">description</span>, <span class="st">"^Date "</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">annotation</span> <span class="op">==</span> <span class="st">"pLoF"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">asd_all_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">ASD185</span>, multiple_phenotypes <span class="op">=</span> <span class="va">phenotypes_filtered</span><span class="op">)</span></span>
<span><span class="va">asd_all_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">asd_all_output</span><span class="op">)</span></span>
<span><span class="va">asd_all_output_tidy</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">dd_all_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">DD477</span>, multiple_phenotypes <span class="op">=</span> <span class="va">phenotypes_filtered</span><span class="op">)</span></span>
<span><span class="va">dd_all_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">dd_all_output</span><span class="op">)</span></span>
<span><span class="va">dd_all_output_tidy</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">ndd_all_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/map_ukbfgsea.html">map_ukbfgsea</a></span><span class="op">(</span>input_geneset <span class="op">=</span> <span class="va">NDD664</span>, multiple_phenotypes <span class="op">=</span> <span class="va">phenotypes_filtered</span><span class="op">)</span></span>
<span><span class="va">ndd_all_output_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tidy_map.html">tidy_map</a></span><span class="op">(</span><span class="va">ndd_all_output</span><span class="op">)</span></span>
<span><span class="va">ndd_all_output_tidy</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="results-interpretation">Results Interpretation<a class="anchor" aria-label="anchor" href="#results-interpretation"></a>
</h3>
<div class="section level4">
<h4 id="identifying-phenotypes-significantly-enriched-with-input-gene-set">Identifying Phenotypes Significantly Enriched with Input Gene Set<a class="anchor" aria-label="anchor" href="#identifying-phenotypes-significantly-enriched-with-input-gene-set"></a>
</h4>
<p>To identify which phenotypes are significantly enriched with ASD, DD and NDD genes respectively, we apply a p-value cutoff and Enrichment Score (ES) filter. Here, we first load the results on filtered phenotypes with the burden test of pLoF variants as examples and apply the criteria.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the tidy results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"asd_all_output_tidy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ndd_all_output_tidy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dd_all_output_tidy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Function to extract the significant phenotypes </span></span>
<span><span class="va">extract_significant_phenotypes</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>description_full <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">description</span>, <span class="st">"; "</span>, <span class="va">coding_description</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">cor_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">beta_pval</span>, <span class="va">data</span><span class="op">$</span><span class="va">sign_pval</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Correlation between beta_pval and sign_pval:"</span>, <span class="va">cor_value</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_sig</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">beta_pval</span> <span class="op">&lt;=</span> <span class="va">cutoff</span>, <span class="va">sign_pval</span> <span class="op">&lt;=</span> <span class="va">cutoff</span>,</span>
<span>           <span class="va">beta_NES</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="va">sign_NES</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>description_full <span class="op">=</span> <span class="fu">fct_reorder</span><span class="op">(</span><span class="va">description_full</span>, <span class="va">beta_pval</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">data_sig</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># extract phenotypes significantly enriched with ASD genes</span></span>
<span><span class="va">significant_with_asd</span> <span class="op">&lt;-</span> <span class="fu">extract_significant_phenotypes</span><span class="op">(</span><span class="va">asd_all_output_tidy</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="do">## [1] "Correlation between beta_pval and sign_pval: 0.698660507602923"</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract phenotypes significantly enriched with DD genes</span></span>
<span><span class="va">significant_with_dd</span> <span class="op">&lt;-</span> <span class="fu">extract_significant_phenotypes</span><span class="op">(</span><span class="va">dd_all_output_tidy</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="do">## [1] "Correlation between beta_pval and sign_pval: 0.752985623493337"</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract phenotypes significantly enriched with NDD genes</span></span>
<span><span class="va">significant_with_ndd</span> <span class="op">&lt;-</span> <span class="fu">extract_significant_phenotypes</span><span class="op">(</span><span class="va">ndd_all_output_tidy</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="do">## [1] "Correlation between beta_pval and sign_pval: 0.737126031432676"</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">significant_with_asd</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="do">## # A tibble: 36 × 34</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="do">##    annotation n_cases n_controls heritability saige_version inv_normalized</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;lgl&gt;         </span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="do">##  1 pLoF          9234     385549       0.0595 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="do">##  2 pLoF          3255     391528       0.0213 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="do">##  3 pLoF          3105     391678       0.0300 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="do">##  4 pLoF          3851     390932       0.140  SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="do">##  5 pLoF          3036     391747       0.0338 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="do">##  6 pLoF          3590     391193       0.0197 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="do">##  7 pLoF          9257     385526       0.0303 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="do">##  8 pLoF          4912     389871       0.0392 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="do">##  9 pLoF          4801     389982       0.0193 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="do">## 10 pLoF          3381     391402       0.0176 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="do">## # ℹ 26 more rows</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="do">## # ℹ 28 more variables: trait_type &lt;chr&gt;, phenocode &lt;chr&gt;, pheno_sex &lt;chr&gt;,</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="do">## #   coding &lt;chr&gt;, modifier &lt;chr&gt;, n_cases_defined &lt;dbl&gt;,</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="do">## #   n_cases_both_sexes &lt;dbl&gt;, n_cases_females &lt;dbl&gt;, n_cases_males &lt;dbl&gt;,</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="do">## #   description &lt;chr&gt;, description_more &lt;chr&gt;, coding_description &lt;chr&gt;,</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="do">## #   category &lt;chr&gt;, beta_pval &lt;dbl&gt;, beta_padj &lt;dbl&gt;, beta_log2err &lt;dbl&gt;,</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="do">## #   beta_ES &lt;dbl&gt;, beta_NES &lt;dbl&gt;, beta_size &lt;int&gt;, beta_leadingEdge &lt;list&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">significant_with_dd</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="do">## # A tibble: 116 × 34</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="do">##    annotation n_cases n_controls heritability saige_version inv_normalized</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;lgl&gt;         </span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="do">##  1 pLoF          9234     385549       0.0595 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="do">##  2 pLoF          5232     389551       0.0234 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="do">##  3 pLoF          3045     391738       0.0757 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="do">##  4 pLoF         15514     379269       0.0646 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="do">##  5 pLoF          3019     391764       0.134  SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="do">##  6 pLoF          3255     391528       0.0213 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="do">##  7 pLoF          4063     390720       0.0746 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="do">##  8 pLoF          5494     389289       0.0199 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="do">##  9 pLoF         22602     372181       0.0131 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="do">## 10 pLoF          5473     389310       0.0147 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="do">## # ℹ 106 more rows</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="do">## # ℹ 28 more variables: trait_type &lt;chr&gt;, phenocode &lt;chr&gt;, pheno_sex &lt;chr&gt;,</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="do">## #   coding &lt;chr&gt;, modifier &lt;chr&gt;, n_cases_defined &lt;dbl&gt;,</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="do">## #   n_cases_both_sexes &lt;dbl&gt;, n_cases_females &lt;dbl&gt;, n_cases_males &lt;dbl&gt;,</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="do">## #   description &lt;chr&gt;, description_more &lt;chr&gt;, coding_description &lt;chr&gt;,</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="do">## #   category &lt;chr&gt;, beta_pval &lt;dbl&gt;, beta_padj &lt;dbl&gt;, beta_log2err &lt;dbl&gt;,</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="do">## #   beta_ES &lt;dbl&gt;, beta_NES &lt;dbl&gt;, beta_size &lt;int&gt;, beta_leadingEdge &lt;list&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">significant_with_ndd</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="do">## # A tibble: 164 × 34</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="do">##    annotation n_cases n_controls heritability saige_version inv_normalized</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="do">##    &lt;chr&gt;        &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;lgl&gt;         </span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="do">##  1 pLoF          9234     385549       0.0595 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="do">##  2 pLoF          5232     389551       0.0234 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="do">##  3 pLoF          3265     391518       0.0331 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="do">##  4 pLoF          7887     386896       0.0206 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="do">##  5 pLoF          5472     389311       0.0218 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="do">##  6 pLoF          3122     391661       0.0124 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="do">##  7 pLoF          3255     391528       0.0213 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="do">##  8 pLoF          4063     390720       0.0746 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="do">##  9 pLoF          5494     389289       0.0199 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="do">## 10 pLoF         22602     372181       0.0131 SAIGE_0.44.5  FALSE         </span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="do">## # ℹ 154 more rows</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="do">## # ℹ 28 more variables: trait_type &lt;chr&gt;, phenocode &lt;chr&gt;, pheno_sex &lt;chr&gt;,</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="do">## #   coding &lt;chr&gt;, modifier &lt;chr&gt;, n_cases_defined &lt;dbl&gt;,</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="do">## #   n_cases_both_sexes &lt;dbl&gt;, n_cases_females &lt;dbl&gt;, n_cases_males &lt;dbl&gt;,</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="do">## #   description &lt;chr&gt;, description_more &lt;chr&gt;, coding_description &lt;chr&gt;,</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="do">## #   category &lt;chr&gt;, beta_pval &lt;dbl&gt;, beta_padj &lt;dbl&gt;, beta_log2err &lt;dbl&gt;,</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="do">## #   beta_ES &lt;dbl&gt;, beta_NES &lt;dbl&gt;, beta_size &lt;int&gt;, beta_leadingEdge &lt;list&gt;, …</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># An example to visualize phenotypes significantly enriched with ASD</span></span>
<span><span class="va">significant_with_asd</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">description_full</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">beta_pval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"-log10(P value from Beta metric)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-3-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="biological-relevance">Biological Relevance<a class="anchor" aria-label="anchor" href="#biological-relevance"></a>
</h4>
<p>We discuss the phenotypes significantly enriched with ASD genes as example here. The results highlight the complex interplay between ASD genes and a wide array of phenotypic traits in the UK Biobank. These findings can be interpreted in several ways:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Comorbidities and Genetic Overlap:</strong> The significant enrichment of ASD genes in conditions like epilepsy, panic attacks, and various physical ailments underscores the multifaceted nature of ASD. It suggests that the genetic basis of ASD may also predispose individuals to other neurological and physical health conditions.</p></li>
<li><p><strong>Implications for Treatment and Management:</strong> Understanding these genetic linkages can inform more comprehensive healthcare strategies for individuals with ASD. For instance, the link between ASD genes and metabolic conditions like diabetes (insulin product usage) can lead to integrated care approaches that address both neurodevelopmental and metabolic health.</p></li>
<li><p><strong>Behavioral and Lifestyle Factors:</strong> The significant enrichment in alcohol consumption categories provides insights into the behavioral patterns associated with ASD. These patterns may be influenced by the genetic makeup of individuals and can have implications for lifestyle interventions and support mechanisms.</p></li>
<li><p><strong>Medical Interventions and Surgical Needs:</strong> The variety of surgeries and medical procedures associated with enriched ASD genes indicate that individuals with ASD might have higher healthcare needs, particularly related to musculoskeletal and chronic conditions. This highlights the importance of specialized medical care and preventive strategies in this population.</p></li>
<li><p><strong>Potential for Further Research:</strong> These findings open avenues for further research into the specific genetic mechanisms underlying these associations. Investigating the pathways and genes involved could lead to better diagnostic tools and targeted therapies for both ASD and its comorbid conditions.</p></li>
</ol>
<p>In conclusion, the significant enrichment of ASD genes across diverse phenotypes in the UK Biobank underscores the broad impact of these genetic factors on health and disease. This analysis not only enhances our understanding of ASD but also informs holistic approaches to healthcare and research for individuals with ASD-related genetic profiles. Future studies should aim to unravel the specific genetic and molecular mechanisms driving these associations to develop more effective interventions and support systems.</p>
<p>We hope this tutorial helps you effectively use the <code>ukbFGSEA</code> package for your gene set enrichment analysis.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>If you find problems, please report them with clear information on <a href="https://github.com/tidyverse/ukbFGSEA/issues" class="external-link">GitHub</a>. You can also contact the authors through email: <code>hedyzhu615@gmail.com</code> and <code>pengjun.guo@outlook.com</code></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ukbFGSEA</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pengjun Guo <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0007-2717-0519" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>He Zhu <br><small class="roles"> Author </small> <a href="https://orcid.org/0009-0001-8483-7910" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AzuleneG/ukbFGSEA/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/AzuleneG/ukbFGSEA/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Pengjun Guo, He Zhu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
